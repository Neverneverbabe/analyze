<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Large File Analysis Uploader</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
        /* Custom styles for flash messages */
        .flash-message {
            padding: 0.75rem 1.25rem;
            margin-bottom: 1rem;
            border: 1px solid transparent;
            border-radius: 0.5rem;
        }
        .flash-success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .flash-error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen">
    <div class="bg-white p-8 rounded-lg shadow-xl w-full max-w-md">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Upload File for Analysis</h1>

        <!-- Flash messages display here -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="mb-4">
            {% for category, message in messages %}
              <div class="flash-message {% if category == 'message' %}flash-success{% else %}flash-error{% endif %}">
                {{ message }}
              </div>
            {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        <form action="/upload" method="post" enctype="multipart/form-data" class="space-y-6">
            <div>
                <label for="file" class="block text-sm font-medium text-gray-700 mb-2">Select CSV or XLSX file:</label>
                <input type="file" name="file" id="file" required
                       class="block w-full text-sm text-gray-900 border border-gray-300 rounded-lg cursor-pointer bg-gray-50
                              focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500
                              file:mr-4 file:py-2 file:px-4
                              file:rounded-full file:border-0
                              file:text-sm file:font-semibold
                              file:bg-blue-50 file:text-blue-700
                              hover:file:bg-blue-100">
                <p class="mt-1 text-xs text-gray-500">Max file size: 1GB</p>
            </div>
            
            <button type="submit"
                    class="w-full px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg shadow-md
                           hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2
                           transition ease-in-out duration-150">
                Upload and Analyze
            </button>
        </form>

        <div class="mt-8 text-sm text-gray-600 text-center">
            <p><strong>Note:</strong> Ensure LM Studio is running and serving a model on <code class="bg-gray-100 px-1 py-0.5 rounded-md">http://localhost:1234</code> for the analysis to work.</p>
            <p class="mt-2">Analysis results will be saved to the '<code class="bg-gray-100 px-1 py-0.5 rounded-md">uploads</code>' folder.</p>
        </div>
    </div>
</body>
</html>

